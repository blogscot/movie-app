{% extends 'templates/default.twig' %}

{% block title %}View Adverts{% endblock %}

{% block content %}

  {% if not auth %}
    <p>Please login to see more details</p>
  {% endif %}

  <form class="default_form" action="{{ urlFor('advert.viewall.post')}}" method="post">
    <label for="search_term">Search:</label>
    <input type="text" name="search_term" id="search_term">
    <button class="btn btn-primary" type="submit">Go</button>
    <input type="hidden" name="{{ csrf_key }}" value="{{ csrf_token }}">
  </form>

  <table class="movie_table">
    <thead>
      <tr>
        {% if auth %}
        <th><strong>Seller</strong></th>
        {% endif %}
        <th><strong>Category</strong></th>
        <th><strong>Movie Title</strong></th>
        <th><strong>Price</strong></th>
        <th></th>
        <th></th>
      </tr>
    </thead>
    {% for advert in adverts if not advert.isSold %}
      <tbody>
        <tr>
          {% if auth %}
            <td>{{ auth.getUsernameById(advert.seller_id) }}</td>
          {% endif %}
          <td>{{ advert.category }}</td>
          <td>{{ advert.title }}</td>
          <td>{{ advert.price|number_format(2,'.',',') }}</td>
          {% if auth %}
            <td><a href="{{ urlFor('advert.view', {id: advert.id}) }}">View Details</a></td>
          {% endif %}
        </tr>
      </tbody>
    {% endfor %}
  </table>

{% endblock %}